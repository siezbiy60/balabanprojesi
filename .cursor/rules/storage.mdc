rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    // Sohbet fotoğrafları (ör: chat_images/...)
    match /chat_images/{allPaths=**} {
      allow read, write: if request.auth != null && request.auth.token.email_verified == true;
    }
    // Profil fotoğrafları (ör: profile_images/kullaniciId.jpg)
    match /profile_images/{userId} {
      allow read, write: if request.auth != null
                         && request.auth.token.email_verified == true
                         && request.auth.uid + '.jpg' == userId;
    }
    // Diğer tüm yollar kapalı
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}